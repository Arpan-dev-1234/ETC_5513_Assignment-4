---
title: "Assignment 4"
author:
- familyname: Sarkar
  othernames: Arpan
  address: India
  email: "asar0035@student.monash.edu"
  correspondingauthor: true
  qualifications: Masters In Business Analytics (Student) 
- familyname: Cui
  othernames: Xinyi
  address: China
  email: "xcui0006@student.monash.edu"
  correspondingauthor: true
  qualifications: Masters In Business Analytics (Student) 
- familyname: Liu
  othernames: Yalong
  address: China
  email: "yliu0406@student.monash.edu"
  correspondingauthor: true
  qualifications:  Masters In Business Analytics (Student)
department: Business Growth Hackers\newline Arpan Sarkar &\newline Xinyi Cui &\newline Yalong Liu
organization: World Bank Group
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, eval = TRUE)
```

```{r loading-packages}
library(tidyverse)
library(plotly)
library(broom)
library(ggResidpanel)
library(kableExtra)
```

# How different states and territory RBT results different from each other?



```{r loading-data, message=FALSE}
alcohol <- read.csv("data/bitre_enforcement_data-rbt.csv") %>% 
rename("Number_of_crash" = "Number.of.deaths.from.crashes.involving.a.driver.or.motorcycle.rider.with.a.blood.alcohol.concentration..BAC..above.the.legal.limit",
       "Number_of_death" = "Number.of.drivers.and.motorcycle.riders.killed.with.a.blood.alcohol.concentration..BAC..above.the.legal.limit")
```

```{r Overview-of-postiveRBT-by-state, fig.height=8, fig.width=12}
p1<- ggplot(alcohol, aes(x = Year, y = Positive.RBT, group = State))+
  geom_line(aes(color=State))+
  geom_point(aes(color=State)) +
  ggtitle("Overview of positive RBT") +
  theme_bw()
  
ggplotly(p1)
```

The graph above presents the positive RBT test result from 2008 to 2019 for each state in Australia. 
Some interesting findings from the graph:

- The highest positive RBT result was in 2010 **Queensland** of 33638 positive results. 

- Queensland and New South Wales are the two states having the highest number of positive RBT.

- In general, there is a decreasing trend for positive RBT over the years for all states and territories

- Tasmania and Australian Capital Territory remained low positive RBT from 2008 to 2019.



From the number of positive RBT result not really illustrates the , as it depends on the number of conducted RBT for each state. Therefore, the RBT ratio is calculated and been plotted as a line graph.
```{r RBT-ratio-by-state}
ratio <- alcohol %>% 
  mutate(RBT_ratio = Positive.RBT /RBT.conducted *100)  

p2<- ggplot(ratio, aes(x = Year, y = RBT_ratio, group = State))+
  geom_line(aes(color=State))+
  geom_point(aes(color=State)) +
  ggtitle("RBT ratio for each state and territory") +
  theme_bw()
  
ggplotly(p2)
```
The graph above illustrates the positive RBT ration for each state from 2008 to 2019.

It is interesting to see that Queensland is no longer the highest in this figure while the Northern Territory have the highest positive RBT ratio for the past 13 years. All other states and territories have a RBT ratio below 1.5 from 2015, whereas NT stayed 7.8 for 2015.

West Australia used to have the second highest RBT ratio in 2008, and it was the second lowest RBT ratio is 2019, it experienced a great improve.

A report released by the Menzies school of research stated that Northern Territory have the highest rates of alcohol consumption per capita in Australia


# Is there a relationship between number of death and positive RBT?
```{r linear-regression}
ratio <- na.omit(ratio) %>% 
  mutate(total_death = Number_of_death + Number_of_crash)

p3 <- ggplot(ratio, aes(x = total_death, y = Positive.RBT)) +
  geom_point()+
  geom_smooth(method = lm)

ggplotly(p3)
```

```{r echo=FALSE}
model <- lm( total_death ~ Positive.RBT, data = ratio)

glance(model) %>% 
  kable() %>% 
  kable_classic()
```
The table is the measures of fit of the model. 

- R.squared is 0.818 which is close to 1.

- Adjusted R.squared is 0.815 which is close to 1.

- Relative low AIC and BIC

Therefore, overall a good model

```{r echo=FALSE}
resid_panel(model, plots = "all")
```

- Residual plot shows the fluctuation of residuals are big as the dots of residuals are not around 0

- Q-Q plots shows the sample and theoretical quantiles not matched with each other, indicating they are not normal distribution. 

- Histogram and boxplots show there are many outliers in the residuals and the residuals are not normally distributed.



In conclusion, it is a moderate model according to the diagnostic plots and the fitness of the model. As there is only one dependent variable (postive RBT) in the model which is not enough to explain the independent variable (Number of road death).
